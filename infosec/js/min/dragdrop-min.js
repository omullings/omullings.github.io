!function(){"use strict";function t(t,i,e){i||(i=250);var o,s;return function(){var n=e||this,l=+new Date,r=arguments;o&&o+i>l?(clearTimeout(s),s=setTimeout(function(){o=l,t.apply(n,r)},i)):(o=l,t.apply(n,r))}}function i(){var t=d.clientWidth,i=window.innerWidth;return i>t?i:t}function e(){var t=d.clientHeight,i=window.innerHeight;return i>t?i:t}function o(){return window.pageXOffset||d.scrollLeft}function s(){return window.pageYOffset||d.scrollTop}function n(t){var i=t.getBoundingClientRect();return{top:i.top+s(),left:i.left+o()}}function l(t,i){t.style.transform=i}function r(t,i){var e=function(t){g.transitions&&this.removeEventListener(u,e),i&&"function"==typeof i&&i.call()};g.transitions?t.addEventListener(u,e):e()}function p(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return t}function h(t,i){this.el=t,this.options=p({},this.options),p(this.options,i)}function a(t,i,e){this.el=t,this.options=p({},this.options),p(this.options,e),this.droppables=i,this.scrollableEl=this.options.scrollable===window?window:document.querySelector(this.options.scrollable),this.scrollIncrement=0,this.options.helper&&(this.offset={left:n(this.el).left,top:n(this.el).top}),this.draggie=new Draggabilly(this.el,this.options.draggabilly),this.initEvents()}var c=document.body,d=window.document.documentElement,f={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},u=f[Modernizr.prefixed("transition")],g={transitions:Modernizr.csstransitions},m=!!getStyleProperty("perspective");h.prototype.options={onDrop:function(t,i){return!1}},h.prototype.isDroppable=function(t){var i=n(t),e=t.offsetWidth,o=t.offsetHeight,s=n(this.el),l=this.el.offsetWidth,r=this.el.offsetHeight;return!(s.left>i.left+e-e/2||s.left+l<i.left+e/2||s.top>i.top+o-o/2||s.top+r<i.top+o/2)},h.prototype.highlight=function(t){this.isDroppable(t)?classie.add(this.el,"highlight"):classie.remove(this.el,"highlight")},h.prototype.collect=function(t){classie.remove(this.el,"highlight"),this.options.onDrop(this,t)},a.prototype.options={scroll:!1,scrollable:window,scrollSpeed:20,scrollSensitivity:10,draggabilly:{},animBack:!0,helper:!1,onStart:function(){return!1},onDrag:function(){return!1},onEnd:function(t){return!1}},a.prototype.initEvents=function(){this.draggie.on("dragStart",this.onDragStart.bind(this)),this.draggie.on("dragMove",t(this.onDragMove.bind(this),5)),this.draggie.on("dragEnd",this.onDragEnd.bind(this))},a.prototype.onDragStart=function(t,i,e){this.options.onStart(),this.position={left:t.position.x,top:t.position.y},this.options.helper&&this.createHelper(t.element),classie.add(t.element,"is-active"),this.highlightDroppables()},a.prototype.onDragMove=function(t,i,e){this.options.onDrag(),this.options.scroll&&this.scrollPage(t.element),this.highlightDroppables()},a.prototype.onDragEnd=function(t,i,e){this.options.helper&&(t.element.style.left=t.position.x+this.position.left+"px",t.element.style.top=t.position.y+this.position.top+"px"),this.options.scroll&&(this.scrollIncrement=0);for(var o=!1,s=0,n=this.droppables.length;n>s;++s){var l=this.droppables[s];l.isDroppable(t.element)&&(o=!0,l.collect(t.element))}this.options.onEnd(o);var p=!0;o&&(classie.add(t.element,"is-dropped"),setTimeout(function(){classie.add(t.element,"is-complete"),r(t.element,function(){classie.remove(t.element,"is-complete"),classie.remove(t.element,"is-dropped")})},25)),(this.position.left===t.position.x&&this.position.top===t.position.y||o)&&(p=!1),this.moveBack(p)},a.prototype.highlightDroppables=function(t){for(var i=0,e=this.droppables.length;e>i;++i)this.droppables[i].highlight(this.el)},a.prototype.createHelper=function(){var t=this.el.cloneNode(!0);classie.remove(t,"is-dragging"),this.el.parentNode.replaceChild(t,this.el);var i=new a(t,this.droppables,this.options);classie.add(this.el,"helper"),this.el.style.left=i.offset.left+"px",this.el.style.top=i.offset.top+"px",this.position.left=i.offset.left,this.position.top=i.offset.top,c.appendChild(this.el)},a.prototype.moveBack=function(t){var i=this.options.animBack&&t;i&&classie.add(this.el,"animate"),l(this.el,m?"translate3d(0,0,0)":"translate(0,0)"),this.el.style.left=this.position.left+"px",this.el.style.top=this.position.top+"px";var e=function(){i&&classie.remove(this.el,"animate"),classie.remove(this.el,"is-active"),this.options.helper&&c.removeChild(this.el)}.bind(this);i?r(this.el,e):e()},a.prototype.outViewport=function(){var t=Math.abs(this.options.scrollSensitivity)||0,i=s(),o=i+e(),l=n(this.el).top,r=l+this.el.offsetHeight/2,p=l+this.el.offsetHeight+t>o,h=i>l-t;return p?this.scrolldir="down":h&&(this.scrolldir="up"),p||h},a.prototype.scrollPage=function(){this.outViewport(this.el)?this.doScroll():this.scrollIncrement=0},a.prototype.doScroll=function(){var t=this.options.scrollSpeed||20;this.scrollIncrement++;var i=this.scrollIncrement<t?this.scrollIncrement:t;this.scrollableEl===window?this.scrollableEl.scrollBy(0,"up"===this.scrolldir?-1*i:i):this.scrollableEl.scrollTop+="up"===this.scrolldir?-1*i:i},window.Droppable=h,window.Draggable=a}();